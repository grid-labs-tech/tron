{# 
  Kubernetes Secret for application component secrets.
  
  SECURITY NOTES:
  - Uses stringData (not data) for automatic base64 encoding by Kubernetes
  - Values are decrypted from Tron's encrypted storage only during deployment
  - Secret values are never logged or exposed via API
  - Kubernetes stores these as base64-encoded in etcd
#}
apiVersion: v1
kind: Secret
metadata:
  name: "{{ application.component_name }}-secrets"
  namespace: "{{ application.application_name }}"
  labels:
    app: "{{ application.component_name }}"
    environment: "{{ application.environment }}"
    managed-by: "tron"
  annotations:
    tron.gridlabs.io/managed: "true"
    tron.gridlabs.io/component-uuid: "{{ application.component_uuid }}"
type: Opaque
stringData:
{% for secret in application.settings.secrets -%}
  {{ secret.key }}: "{{ secret.value }}"
{% endfor %}
